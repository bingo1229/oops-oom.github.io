# Dapr

<img src="http://devops-1255386119.cos.ap-beijing.myqcloud.com/2023-01-08-145654.png" alt="img" style="zoom:80%;" />


参考[Containers vs. virtual machines](https://www.atlassian.com/microservices/cloud-computing/containers-vs-vms)



runc runv runz runsz


https://stackoverflow.com/questions/21887797/what-is-the-overhead-of-a-context-switch?noredirect=1&lq=1

https://stackoverflow.com/questions/21887797/what-is-the-overhead-of-a-context-switch?noredirect=1&lq=1

https://www.intel.com/content/www/us/en/docs/programmable/683013/current/processor-affinity-or-cpu-pinning.html#:~:text=Processor%20affinity%20takes%20advantage%20of,re%2Dscheduled%20after%20being%20preempted.



平台做物理的利用率，业务提升逻辑的利用率



## 其他

### TODO

正好最近在准备在serverless方向搞点东西，所以从以下几个方面深入学习整理下，也算是个积累。

1. 线程和进程的本质 
  
   > cpu、process、schedule
   
2. IO多路复用
  
   > select、poll、epoll
   
3. 协程 

   > nginx lua、libco、goroutine

4. 虚拟机

   > kvm、hypervisor

5. 容器

   > cgroups、namespace、overlayfs

6. k8s 

   > hpa、vpa、istio、serverless、mesh



[3]: https://stackoverflow.com/questions/16047306/how-is-docker-different-from-a-virtual-machine	"how-is-docker-different-from-a-virtual-machine"
[4]: https://stackoverflow.com/questions/29096967/what-are-the-differences-between-a-vm-image-and-a-docker-image	"how-is-docker-different-from-a-virtual-machine"

http://ec.ctiforum.com/jishu/qiye/wenzhai/533686.html

https://www.zhihu.com/question/26895729

https://www.quora.com/What-is-the-difference-between-Kubernetes-and-OpenStack



[https://pages.cs.wisc.edu/~remzi/OSTEP/]: 

https://developer.aliyun.com/article/845278?utm_content=m_1000316488

https://www.infoq.cn/article/xkjnoczvdharlkkjvdom

标准的进化

优化资源的利用率

富容器 - 兼容旧系统

kubevirt和virtlet

k8s native

容器+轻量级虚拟机是未来中期的主流趋势，比如腾讯云当前的EKS产品。

容器+神龙裸金属服务器是阿里云容器服务的当前的主推产品方案，腾讯云也在持续投入容器+黑石，但战略地位略有差异。

> 为什么裸金属会受到青睐呢？如果底层是虚拟机，容器想要正常运行，那么就需要在虚拟机与容器之间增加一层虚拟化软件调度系统，这层调度系统会与 Kubernetes 的容器调度做叠加，产生性能损耗，而使用裸金属服务器就无需这层调度系统，可以直接运行容器。
>
>  [摘自解读华为云容器的战略布局，裸金属容器服务会是互联网新趋势吗？](https://www.infoq.cn/article/ui0oy4vx9tll8rvt6xg7)

虚拟机使用docker镜像？！

> Kata Containers is an interesting technology, it combines the speed of deployment of Docker containers with the isolation of virtual machines and its security advantages.





[CNCF Landscape](https://landscape.cncf.io/?fullscreen=yes)



降低心智负担

可扩展、可复制

敏捷的



人效

机效



抽象底层



CICD

编排管理

DevOps



不可变基础设施 -> 随时替换

基础设施的一致性和可靠性  自包含、可漂移



![image-20230108130905136](http://devops-1255386119.cos.ap-beijing.myqcloud.com/2023-01-08-050909.png)



云应用编排理论



自包含的运行环境





![image-20230108114957609](http://devops-1255386119.cos.ap-beijing.myqcloud.com/2023-01-08-035719.png)



<img src="http://devops-1255386119.cos.ap-beijing.myqcloud.com/2023-01-10-055432.jpg" alt="img" style="zoom:80%;" />

https://raw.githubusercontent.com/kata-containers/kata-containers/main/docs/design/arch-images/katacontainers-e2e-with-bg.jpg
